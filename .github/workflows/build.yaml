name: build
on: push
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-go@v3
        with:
          go-version: '1.18.5'
      - uses: actions/setup-python@v4
        with:
          python-version: 3.8
      - name: check-gofmt
        run: make checkfmt
        shell: bash
      - name: Lint
        run: make vet
        shell: bash
      - name: check with ShellCheck
        run: make install-shellcheck
        shell: bash
      - name: Check with boilerplate
        run: make verify-boilerplate
        shell: bash
      - name: Install yamllint
        run: pip install yamllint
      - name: check with yamlint
        run: yamllint -c .github/linters/yaml-lint.yaml . --format github
      - name: check with golangci
        uses: golangci/golangci-lint-action@v3
        with:
          version: v1.46.2 # https://github.com/golangci/golangci-lint/releases
          working-directory: ${{matrix.working-directory}}
