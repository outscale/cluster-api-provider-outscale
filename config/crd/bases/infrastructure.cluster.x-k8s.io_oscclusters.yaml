---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.1-0.20251030134004-a51cd00d7bc6
  name: oscclusters.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: OscCluster
    listKind: OscClusterList
    plural: oscclusters
    singular: osccluster
  scope: Namespaced
  versions:
  - name: v1beta1
    schema:
      openAPIV3Schema:
        description: OscCluster is the Schema for the oscclusters API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: OscClusterSpec defines the desired state of OscCluster
            properties:
              controlPlaneEndpoint:
                description: APIEndpoint represents a reachable Kubernetes API endpoint.
                properties:
                  host:
                    description: host is the hostname on which the API server is serving.
                    maxLength: 512
                    type: string
                  port:
                    description: port is the port on which the API server is serving.
                    format: int32
                    type: integer
                required:
                - host
                - port
                type: object
              credentials:
                properties:
                  fromFile:
                    description: Load credentials from this file instead of the env.
                    type: string
                  fromSecret:
                    description: Load credentials from this secret instead of the
                      env.
                    type: string
                  profile:
                    description: Name of profile stored in file (unused using fromSecret,
                      "default" by default).
                    type: string
                type: object
              network:
                properties:
                  additionalSecurityRules:
                    description: Additional rules to add to the automatic security
                      groups
                    items:
                      properties:
                        roles:
                          description: The roles of automatic securityGroup to add
                            rules to.
                          items:
                            type: string
                          type: array
                        rules:
                          description: The rules to add.
                          items:
                            properties:
                              flow:
                                description: The flow of the security group (inbound
                                  or outbound)
                                type: string
                              fromPortRange:
                                description: The beginning of the port range
                                format: int32
                                type: integer
                              ipProtocol:
                                description: The ip protocol name (tcp, udp, icmp
                                  or -1)
                                type: string
                              ipRange:
                                description: The ip range of the security group rule
                                  (deprecated, use ipRanges)
                                type: string
                              ipRanges:
                                description: The list of ip ranges of the security
                                  group rule
                                items:
                                  type: string
                                type: array
                              name:
                                description: The tag name associate with the security
                                  group
                                type: string
                              resourceId:
                                description: The security group rule id
                                type: string
                              toPortRange:
                                description: The end of the port range
                                format: int32
                                type: integer
                            type: object
                          type: array
                      type: object
                    type: array
                  allowFromIPRanges:
                    description: The list of IP ranges (in CIDR notation) to restrict
                      bastion/Kubernetes API access to.
                    items:
                      type: string
                    type: array
                  allowToIPRanges:
                    description: The list of IP ranges (in CIDR notation) the nodes
                      can talk to ("0.0.0.0/0" if not set).
                    items:
                      type: string
                    type: array
                  bastion:
                    description: The bastion configuration
                    properties:
                      PublicIpId:
                        description: The ID of an existing public IP to use for this
                          VM.
                        type: string
                      clusterName:
                        description: unused
                        type: string
                      deviceName:
                        description: unused
                        type: string
                      enable:
                        type: boolean
                      imageAccountId:
                        type: string
                      imageId:
                        type: string
                      imageName:
                        type: string
                      keypairName:
                        type: string
                      name:
                        type: string
                      privateIps:
                        items:
                          properties:
                            name:
                              type: string
                            privateIp:
                              type: string
                          type: object
                        type: array
                      publicIpName:
                        description: unused
                        type: string
                      resourceId:
                        description: the vm id (deprecated, not set anymore)
                        type: string
                      rootDisk:
                        properties:
                          rootDiskIops:
                            description: The root disk iops (io1 volumes only) (1500
                              by default)
                            format: int32
                            type: integer
                          rootDiskSize:
                            description: The volume size in gibibytes (GiB) (60 by
                              default)
                            format: int32
                            type: integer
                          rootDiskType:
                            description: The volume type (io1, gp2 or standard) (io1
                              by default)
                            type: string
                        type: object
                      securityGroupNames:
                        description: The list of security groups (deprecated use bastion
                          role in security groups)
                        items:
                          properties:
                            name:
                              type: string
                          type: object
                        type: array
                      subnetName:
                        description: The subnet of the vm (deprecated use bastion
                          role in subnets)
                        type: string
                      subregionName:
                        description: unused
                        type: string
                      vmType:
                        description: The type of VM (tinav6.c1r1p2 by default)
                        type: string
                    type: object
                  clusterName:
                    description: The name of the cluster (unused)
                    type: string
                  controlPlaneSubnets:
                    description: List of subnet to spread controlPlane nodes (deprecated,
                      add controlplane role to subnets)
                    items:
                      type: string
                    type: array
                  disable:
                    description: List of disabled features (internet = no internet
                      service, no nat services)
                    items:
                      enum:
                      - internet
                      type: string
                    type: array
                  extraSecurityGroupRule:
                    description: (unused)
                    type: boolean
                  image:
                    description: The image configuration (unused)
                    properties:
                      accountId:
                        description: The image account owner ID.
                        type: string
                      name:
                        description: The image name.
                        type: string
                      outscaleOpenSource:
                        description: Use an "Outscale Opensource" image
                        type: boolean
                      resourceId:
                        description: unused
                        type: string
                    type: object
                  internetService:
                    description: The Internet Service configuration
                    properties:
                      clusterName:
                        description: the name of the cluster (unused)
                        type: string
                      name:
                        description: The name of the Internet service
                        type: string
                      resourceId:
                        description: the Internet Service resource id (unused)
                        type: string
                    type: object
                  loadBalancer:
                    description: The Load Balancer configuration
                    properties:
                      clusterName:
                        description: unused
                        type: string
                      healthCheck:
                        description: The healthCheck configuration of the Load Balancer
                        properties:
                          checkinterval:
                            description: the time in second between two pings
                            format: int32
                            type: integer
                          healthythreshold:
                            description: the consecutive number of pings which are
                              successful to consider the vm healthy
                            format: int32
                            type: integer
                          port:
                            description: the HealthCheck port number
                            format: int32
                            type: integer
                          protocol:
                            description: The HealthCheck protocol ('HTTP'|'TCP')
                            type: string
                          timeout:
                            description: the Timeout to consider VM unhealthy
                            format: int32
                            type: integer
                          unhealthythreshold:
                            description: the consecutive number of pings which are
                              failed to consider the vm unhealthy
                            format: int32
                            type: integer
                        type: object
                      listener:
                        description: The Listener configuration of the loadBalancer
                        properties:
                          backendport:
                            description: The port on which the backend VMs will listen
                            format: int32
                            type: integer
                          backendprotocol:
                            description: The protocol ('HTTP'|'TCP') to route the
                              traffic to the backend vm
                            type: string
                          loadbalancerport:
                            description: The port on which the loadbalancer will listen
                            format: int32
                            type: integer
                          loadbalancerprotocol:
                            description: the routing protocol ('HTTP'|'TCP')
                            type: string
                        type: object
                      loadbalancername:
                        description: The Load Balancer unique name
                        type: string
                      loadbalancertype:
                        description: The Load Balancer type (internet-facing or internal)
                        type: string
                      securitygroupname:
                        description: The security group name for the load-balancer
                          (deprecated, add loadbalancer role to a security group)
                        type: string
                      subnetname:
                        description: The subnet name where to add the load balancer
                          (deprecated, add loadbalancer role to a subnet)
                        type: string
                    type: object
                  natPublicIpPool:
                    description: The IP Pool storing the Nat Services public IPs
                    type: string
                  natService:
                    description: The Nat Service configuration
                    properties:
                      clusterName:
                        description: The name of the cluster (unused)
                        type: string
                      name:
                        description: The name of the Nat Service
                        type: string
                      publicipname:
                        description: The Public Ip name (unused)
                        type: string
                      resourceId:
                        description: The resource id (unused)
                        type: string
                      subnetname:
                        description: The name of the Subnet to which the Nat Service
                          will be attached (deprecated, add nat role to subnets)
                        type: string
                      subregionName:
                        description: The name of the Subregion to which the Nat Service
                          will be attached, unless a subnet has been defined (unused)
                        type: string
                    type: object
                  natServices:
                    description: The Nat Services configuration
                    items:
                      properties:
                        clusterName:
                          description: The name of the cluster (unused)
                          type: string
                        name:
                          description: The name of the Nat Service
                          type: string
                        publicipname:
                          description: The Public Ip name (unused)
                          type: string
                        resourceId:
                          description: The resource id (unused)
                          type: string
                        subnetname:
                          description: The name of the Subnet to which the Nat Service
                            will be attached (deprecated, add nat role to subnets)
                          type: string
                        subregionName:
                          description: The name of the Subregion to which the Nat
                            Service will be attached, unless a subnet has been defined
                            (unused)
                          type: string
                      type: object
                    type: array
                  net:
                    description: The Net configuration
                    properties:
                      clusterName:
                        description: the name of the cluster (unused)
                        type: string
                      ipRange:
                        description: the ip range in CIDR notation of the Net
                        type: string
                      name:
                        description: the network name
                        type: string
                      resourceId:
                        description: The Id of the Net to reuse (if useExisting.net
                          is set)
                        type: string
                    type: object
                  netAccessPoints:
                    description: The NetAccessPoints configuration, required if internet
                      is disabled.
                    items:
                      enum:
                      - api
                      - directlink
                      - eim
                      - kms
                      - lbu
                      - oos
                      type: string
                    type: array
                  netPeering:
                    description: The NetPeering configuration, required if the load
                      balancer is internal, and management and workload clusters are
                      on separate VPCs.
                    properties:
                      enable:
                        description: Create a NetPeering between the management and
                          workload VPCs.
                        type: boolean
                      managementAccountId:
                        description: The management cluster account ID (optional,
                          fetched from the metadata server if not set).
                        type: string
                      managementCredentials:
                        description: The credentials of the management cluster account.
                          Required if management and workload cluster are not in the
                          same account.
                        properties:
                          fromFile:
                            description: Load credentials from this file instead of
                              the env.
                            type: string
                          fromSecret:
                            description: Load credentials from this secret instead
                              of the env.
                            type: string
                          profile:
                            description: Name of profile stored in file (unused using
                              fromSecret, "default" by default).
                            type: string
                        type: object
                      managementNetId:
                        description: The management cluster net ID (optional, fetched
                          from the metadata server if not set).
                        type: string
                      managementSubnetId:
                        description: By default, all subnets of managementNetId are
                          routed to the netPeering. If set, only the specified subnet
                          will be routed.
                        type: string
                    type: object
                  publicIps:
                    description: The Public Ip configuration (unused)
                    items:
                      properties:
                        clusterName:
                          description: unused
                          type: string
                        name:
                          description: The tag name associate with the Public Ip (unused)
                          type: string
                        resourceId:
                          description: The Public Ip Id response (unused)
                          type: string
                      type: object
                    type: array
                  routeTables:
                    description: The Route Table configuration
                    items:
                      properties:
                        name:
                          description: The tag name associate with the Route Table
                          type: string
                        resourceId:
                          description: The resource id (unused)
                          type: string
                        role:
                          description: The role for this route table
                          type: string
                        routes:
                          description: The Route configuration
                          items:
                            properties:
                              destination:
                                description: the destination match Ip range with CIDR
                                  notation
                                type: string
                              name:
                                description: The tag name associate with the Route
                                type: string
                              resourceId:
                                description: The Route Id response
                                type: string
                              targetName:
                                description: The tag name associate with the target
                                  resource type
                                type: string
                              targetType:
                                description: The target resource type which can be
                                  Internet Service (gateway) or Nat Service (nat-service)
                                type: string
                            type: object
                          type: array
                        subnets:
                          description: The subnet tag name associate with a Subnet
                            (deprecated, use roles)
                          items:
                            type: string
                          type: array
                        subregionName:
                          description: The subregion for this route table
                          type: string
                      type: object
                    type: array
                  securityGroups:
                    description: The Security Groups configuration.
                    items:
                      properties:
                        authoritative:
                          description: Is the Security Group configuration authoritative
                            ? (if yes, all rules not found in configuration will be
                            deleted).
                          type: boolean
                        description:
                          description: The description of the security group
                          type: string
                        name:
                          description: The name of the security group
                          type: string
                        resourceId:
                          description: When useExisting.securityGroup is set, the
                            id of an existing securityGroup to use.
                          type: string
                        roles:
                          description: The roles the securityGroup applies to.
                          items:
                            type: string
                          type: array
                        securityGroupRules:
                          description: The list of rules for this securityGroup.
                          items:
                            properties:
                              flow:
                                description: The flow of the security group (inbound
                                  or outbound)
                                type: string
                              fromPortRange:
                                description: The beginning of the port range
                                format: int32
                                type: integer
                              ipProtocol:
                                description: The ip protocol name (tcp, udp, icmp
                                  or -1)
                                type: string
                              ipRange:
                                description: The ip range of the security group rule
                                  (deprecated, use ipRanges)
                                type: string
                              ipRanges:
                                description: The list of ip ranges of the security
                                  group rule
                                items:
                                  type: string
                                type: array
                              name:
                                description: The tag name associate with the security
                                  group
                                type: string
                              resourceId:
                                description: The security group rule id
                                type: string
                              toPortRange:
                                description: The end of the port range
                                format: int32
                                type: integer
                            type: object
                          type: array
                        tag:
                          type: string
                      type: object
                    type: array
                  subnets:
                    description: The Subnets configuration
                    items:
                      properties:
                        ipSubnetRange:
                          description: the Ip range in CIDR notation of the Subnet
                          type: string
                        name:
                          description: The name of the Subnet
                          type: string
                        resourceId:
                          description: The id of the Subnet to reuse (if useExisting.net
                            is set)
                          type: string
                        roles:
                          description: The role of the Subnet (controlplane, worker,
                            loadbalancer, bastion or nat)
                          items:
                            type: string
                          type: array
                        subregionName:
                          description: The subregion name of the Subnet
                          type: string
                      type: object
                    type: array
                  subregionName:
                    description: The default subregion name (deprecated, use subregions)
                    type: string
                  subregions:
                    description: The list of subregions where to deploy this cluster
                    items:
                      type: string
                    type: array
                  useExisting:
                    description: Reuse externally managed resources ?
                    properties:
                      net:
                        description: If set, net, subnets, internet service, nat services
                          and route tables are externally managed
                        type: boolean
                      securityGroups:
                        description: If set, security groups are externally managed.
                        type: boolean
                    type: object
                type: object
            type: object
          status:
            description: OscClusterStatus defines the observed state of OscCluster
            properties:
              conditions:
                description: Conditions provide observations of the operational state
                  of a Cluster API resource.
                items:
                  description: Condition defines an observation of a Cluster API resource
                    operational state.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed. If that is not known, then using the time when
                        the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This field may be empty.
                      maxLength: 10240
                      minLength: 1
                      type: string
                    reason:
                      description: |-
                        reason is the reason for the condition's last transition in CamelCase.
                        The specific API may choose whether or not this field is considered a guaranteed API.
                        This field may be empty.
                      maxLength: 256
                      minLength: 1
                      type: string
                    severity:
                      description: |-
                        severity provides an explicit classification of Reason code, so the users or machines can immediately
                        understand the current situation and act accordingly.
                        The Severity field MUST be set only when Status=False.
                      maxLength: 32
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      type: string
                    type:
                      description: |-
                        type of condition in CamelCase or in foo.example.com/CamelCase.
                        Many .condition.type values are consistent across resources like Available, but because arbitrary conditions
                        can be useful (see .node.status.conditions), the ability to deconflict is important.
                      maxLength: 256
                      minLength: 1
                      type: string
                  required:
                  - lastTransitionTime
                  - status
                  - type
                  type: object
                type: array
              failureDomains:
                additionalProperties:
                  description: |-
                    FailureDomainSpec is the Schema for Cluster API failure domains.
                    It allows controllers to understand how many failure domains a cluster can optionally span across.
                  properties:
                    attributes:
                      additionalProperties:
                        type: string
                      description: attributes is a free form map of attributes an
                        infrastructure provider might use or require.
                      type: object
                    controlPlane:
                      description: controlPlane determines if this failure domain
                        is suitable for use by control plane machines.
                      type: boolean
                  type: object
                description: FailureDomains is a slice of FailureDomains.
                type: object
              network:
                description: deprecated, replaced by resources
                properties:
                  LoadbalancerRef:
                    description: Map between LoadbalancerId and LoadbalancerName (not
                      set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  bastionref:
                    description: Map between InstanceId  and BastionName (not set
                      anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  internetserviceref:
                    description: Map between InternetServiceId  and InternetServiceName
                      (not set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  linkPublicIpRef:
                    description: Map between LinkPublicIpId  and PublicIpName (not
                      set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  linkroutetableref:
                    additionalProperties:
                      items:
                        type: string
                      type: array
                    description: Map between LinkRouteTableId and RouteTablesName
                      (not set anymore)
                    type: object
                  natref:
                    description: Map between NatServiceId  and NatServiceName (not
                      set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  netref:
                    description: Map between NetId  and NetName (not set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  publicipref:
                    description: Map between PublicIpId  and PublicIpName (not set
                      anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  routeref:
                    description: Map between RouteId  and RouteName (not set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  routetableref:
                    description: Map between RouteTablesId  and RouteTablesName (not
                      set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  securitygroupref:
                    description: Map between SecurityGroupId  and SecurityGroupName
                      (not set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  securitygroupruleref:
                    description: Map between SecurityGroupRuleId  and SecurityGroupName
                      (not set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  subnetref:
                    description: Map between SubnetId  and SubnetName (not set anymore)
                    properties:
                      resourceMap:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                type: object
              ready:
                type: boolean
              reconcilerGeneration:
                additionalProperties:
                  format: int64
                  type: integer
                type: object
              resources:
                properties:
                  bastion:
                    additionalProperties:
                      type: string
                    type: object
                  internetService:
                    additionalProperties:
                      type: string
                    type: object
                  natService:
                    additionalProperties:
                      type: string
                    type: object
                  net:
                    additionalProperties:
                      type: string
                    type: object
                  netAccessPoint:
                    additionalProperties:
                      type: string
                    type: object
                  netPeering:
                    additionalProperties:
                      type: string
                    type: object
                  publicIps:
                    additionalProperties:
                      type: string
                    type: object
                  securityGroup:
                    additionalProperties:
                      type: string
                    type: object
                  subnet:
                    additionalProperties:
                      type: string
                    type: object
                type: object
              vmState:
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
